<!DOCTYPE html>
<html>
  <head>
    <title>School Manager</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= javascript_importmap_tags %>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >
    <link 
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" 
      rel="stylesheet">
    <link 
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" 
      rel="stylesheet">

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "classlist", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "department", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "guardian", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "student_guardian", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "section", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "staff", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "student", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "subject", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "teacher", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "homepage", "data-turbo-track": "reload" %>
  </head>

 <body>
  <% if controller_name == "home" && action_name == "index" %>
    <%= yield %>
  <% else %>
    
    <div class="d-flex" id="wrapper">
      <nav class="sidebar-container d-flex flex-column">
        
        <div class="sidebar-header logo-wrapper p-4 d-flex align-items-center gap-3 logo-bg">
  
        <div class="logo-img-wrapper d-flex align-items-center justify-content-center">
          <%= image_tag "Logo.png", class: "logo-style" %>
        </div>  

          <div class="d-flex flex-column">
            <h5 class="fw-bold mb-0 logo-main-text">WISTERIA GROVE</h5>
           <span class="logo-subtext">UNIVERSITY</span>
          </div>

        </div>
 
        <hr class="sidebar-divider-top">
        
        <div class="sidebar-search px-4 py-3">
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-search"></i></span>
            <input type="text" class="form-control" placeholder="Search WGU...">
          </div>
        </div>
        
        <hr class="sidebar-divider-bottom">


        <div class="sidebar-menu flex-grow-1 overflow-auto">
          <ul class="nav flex-column px-3">
            
            <li class="nav-item mb-2">
              <%= link_to root_path, class: "nav-link d-flex align-items-center gap-3 text-white #{'active-link' if current_page?(root_path)}" do %>
                <i class="bi bi-house fs-5"></i>
                <span>Home</span>
              <% end %>
            </li>

            <li class="nav-item mb-2">
              <%= link_to "#", class: "nav-link d-flex align-items-center gap-3 text-white #{'active-link' if controller_name == 'news'}" do %>
                <i class="bi bi-newspaper fs-5"></i>
                <span>News</span>
              <% end %>
            </li>

            <li class="nav-item mb-2">
              <% manager_controllers = ['students', 'teachers', 'sections', 'subjects', 'classlists', 'staffs', 'departments', 'guardians', 'relationships'] %>
              <a class="nav-link d-flex align-items-center gap-3 text-white collapsed <%= 'active-link' if manager_controllers.include?(controller_name) %>" 
                data-bs-toggle="collapse" 
                href="#managerSubmenu" 
                role="button" 
                aria-expanded="<%= manager_controllers.include?(controller_name) %>">
                <i class="bi bi-grid fs-5"></i>
                <span class="flex-grow-1">Manager</span>
                <i class="bi bi-chevron-down ms-auto small-icon"></i>
              </a>

              <div class="collapse <%= 'show' if manager_controllers.include?(controller_name) %>" id="managerSubmenu">
                <ul class="nav flex-column ms-4 mt-2 border-start ps-2">

                  <!-- Departments -->
                  <li class="nav-item">
                    <%= link_to departments_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'departments'}" do %>
                      <span>Departments</span>
                    <% end %>
                  </li>

                  <!-- Teachers -->
                  <li class="nav-item">
                    <%= link_to teachers_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'teachers'}" do %>
                      <span>Teachers</span>
                    <% end %>
                  </li>

                  <!-- Students -->
                  <li class="nav-item">
                    <%= link_to students_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'students'}" do %>
                      <span>Students</span>
                    <% end %>
                  </li>

                  <!-- Subjects -->
                  <li class="nav-item">
                    <%= link_to subjects_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'subjects'}" do %>
                      <span>Subjects</span>
                    <% end %>
                  </li>

                  <!-- Sections -->
                  <li class="nav-item">
                    <%= link_to sections_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'sections'}" do %>
                      <span>Sections</span>
                    <% end %>
                  </li>

                  <!-- Staffs -->
                  <li class="nav-item">
                    <%= link_to staffs_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'staffs'}" do %>
                      <span>Staffs</span>
                    <% end %>
                  </li>

                  <!-- Classlists -->
                  <li class="nav-item">
                    <%= link_to classlists_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'classlists'}" do %>
                      <span>Classlists</span>
                    <% end %>
                  </li>

                  <!-- Guardians -->
                  <li class="nav-item">
                    <%= link_to guardians_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'guardians'}" do %>
                      <span>Guardians</span>
                    <% end %>
                  </li>

                  <!-- Relationships -->
                  <li class="nav-item">
                    <%= link_to student_guardians_path, class: "nav-link py-1 text-white #{'submenu-active-link' if controller_name == 'relationships'}" do %>
                      <span>Relationships</span>
                    <% end %>
                  </li>

                </ul>
              </div>
            </li>

            <li class="nav-item mb-2">
              <%= link_to "#", class: "nav-link d-flex align-items-center gap-3 text-white" do %>
                <i class="bi bi-info-circle fs-5"></i>
                <span>About Us</span>
              <% end %>
            </li>

            <li class="nav-item mb-2">
              <%= link_to "#", class: "nav-link d-flex align-items-center gap-3 text-white" do %>
                <i class="bi bi-envelope fs-5"></i>
                <span>Contact Us</span>
              <% end %>
            </li>
            
          </ul>
        </div>

        <div class="sidebar-footer p-3 border-top mt-auto">
          <ul class="nav flex-column">
             <li class="nav-item mb-2">
              <%= link_to "#", class: "nav-link d-flex align-items-center gap-3 text-white" do %>
                <i class="bi bi-gear fs-5"></i>
                <span>Settings</span>
              <% end %>
            </li>
            <li class="nav-item">
               <%= button_to "Log Out", "#", method: :delete, class: "btn btn-dark w-100 fw-bold" %> 
            </li>
          </ul>
        </div>
      </nav>

      <main class="content-wrapper flex-grow-1">
        
        <div class="content-card-container">

          <div class="flash-container position-relative">
            <% flash.each do |key, message| %>
              <div class="auto-dismiss-alert alert alert-<%= key == "notice" ? "success" : "danger" %> shadow-sm m-3" role="alert">
                <%= message %>
              </div>
            <% end %>
          </div>

          <div class="p-4">
            <%= yield %>
          </div>
          
        </div>
      </main>
    </div>
  <% end %>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>